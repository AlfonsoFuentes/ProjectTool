@page "/NewReceivePurchaseOrder/{PurchaseOrderId:guid}"
@using ClientRadzen.NewPages.PurchaseOrder.Createds

<PageTitle>Receive Purchase Requisition </PageTitle>
@if (debug)
{

}
@if (Model != null)
{

    <RadzenStack Orientation="Orientation.Vertical">
        <RadzenRow>
            <RadzenText TextStyle="TextStyle.DisplayH5"
                        Text="@($"Receive Purchase Order {Model.PurchaseOrderNumber} in {Model.MWOCECName} {Model.MWOName}")"></RadzenText>
        </RadzenRow>


        <EditForm Model="@Model" OnValidSubmit="ValidateAsync">
            <FluentValidationValidator @ref="_fluentValidationValidator" />
            <RadzenRow>
                <RadzenColumn Size="12" SizeMD="3">
                    <RadzenFormField Text="Purchase order Number" Style="width: 100%;">
                        <RadzenTextBox @bind-Value=@Model.PurchaseOrderNumber class="w-100" Disabled=true
                                       Name="PONumber" />

                    </RadzenFormField>



                </RadzenColumn>
                <RadzenColumn Size="12" SizeMD="3">
                    <RadzenFormField Text="Purchase order Expected date" Style="width: 100%;">
                        <RadzenDatePicker @bind-Value=@Model.ExpectedDate Name="expetedon" AllowClear=true DateFormat="d"
                                          Disabled=true
                                          TValue="DateTime?">

                        </RadzenDatePicker>

                    </RadzenFormField>



                </RadzenColumn>
                <RadzenColumn Size="12" SizeMD="6">
                    <RadzenFormField Text="Purchase order Name" Style="width: 100%;">
                        <RadzenText Text=@Model.PurchaseorderName class=@UISettings.TextBoxWithFieldNameclass Style="width: 100%;" />


                    </RadzenFormField>


                </RadzenColumn>
            </RadzenRow>


            <RadzenRow>

                <RadzenColumn Size="12" SizeMD="6">
                    <RadzenFormField Text="Supplier" Style="width: 100%;">
                        <RadzenText Text=@Model.SupplierName class=@UISettings.TextBoxWithFieldNameclass Style="width: 100%;" />



                    </RadzenFormField>

                </RadzenColumn>
                <RadzenColumn Size="12" SizeMD="3">

                    <RadzenFormField Text="Vendor Code" Style="width: 100%; height:100%">
                        <RadzenText Text=@Model.SupplierVendorCode class=@UISettings.TextBoxWithFieldNameclass Style="width: 100%;" />
                    </RadzenFormField>

                </RadzenColumn>
                <RadzenColumn Size="12" SizeMD="3">

                    <RadzenFormField Text="Tax Code" Style="width: 100%; height:100%">
                        <RadzenText Text=@Model.TaxCode class=@UISettings.TextBoxWithFieldNameclass Style="width: 100%;" />
                    </RadzenFormField>

                </RadzenColumn>

            </RadzenRow>
            <RadzenRow>
                <RadzenColumn Size="12" SizeMD="3">
                    <RadzenFormField Text="Purchase Requisition" Style="width: 100%;">
                        <RadzenText Text=@Model.PurchaseRequisition class=@UISettings.TextBoxWithFieldNameclass Style="width: 100%;" />


                    </RadzenFormField>

                </RadzenColumn>
                <RadzenColumn Size="12" SizeMD="3">
                    <RadzenFormField Text="Quote No" Style="width: 100%;">
                        <RadzenText Text=@Model.QuoteNo class=@UISettings.TextBoxWithFieldNameclass Style="width: 100%;" />


                    </RadzenFormField>

                </RadzenColumn>
                @if (Model.IsAlteration)
                {
                    <RadzenColumn Size="12" SizeMD="3">
                        <RadzenFormField Text="Account" Style="width: 100%;">

                            <RadzenText Text=@Model.AccountAssigment class=@UISettings.TextBoxWithFieldNameclass Style="width: 100%;" />
                        </RadzenFormField>
                    </RadzenColumn>
                    <RadzenColumn Size="12" SizeMD="3">
                        <RadzenFormField Text="MWO" Style="width: 100%;">

                            <RadzenText Text=@Model.MWOCECName class=@UISettings.TextBoxWithFieldNameclass Style="width: 100%;" />
                        </RadzenFormField>
                    </RadzenColumn>
                }
                else
                {
                    <RadzenColumn Size="12" SizeMD="6">
                        <RadzenFormField Text="Account" Style="width: 100%;">

                            <RadzenText Text=@Model.AccountAssigment class=@UISettings.TextBoxWithFieldNameclass Style="width: 100%;" />
                        </RadzenFormField>
                    </RadzenColumn>
                }
            </RadzenRow>
            <RadzenRow>
                <RadzenColumn Size="12" SizeMD="3">
                    <RadzenFormField Text="Quote Currency" Style="width: 100%;">

                        <RadzenText Text=@Model.QuoteCurrency.Name class=@UISettings.TextBoxWithFieldNameclass Style="width: 100%;" />
                    </RadzenFormField>



                </RadzenColumn>
                <RadzenColumn Size="12" SizeMD="3">
                    @if (Model.PurchaseOrderCurrency.Id == CurrencyEnum.COP.Id)
                    {
                        <RadzenRow>
                            <RadzenColumn Size="12" SizeMD="12">
                                <RadzenFormField Text=@($"PO TRM ") Style="width: 100%;">

                                    <RadzenText Text=@Model.USDCOP.ToString() class=@UISettings.TextBoxWithFieldNameclass Style="width: 100%;" />
                                </RadzenFormField>

                            </RadzenColumn>




                        </RadzenRow>

                    }
                    else if (Model.PurchaseOrderCurrency.Id == CurrencyEnum.EUR.Id)
                    {
                        <RadzenRow>
                            <RadzenColumn Size="12" SizeMD="12">
                                <RadzenFormField Text=@($"PO TRM ") Style="width: 100%;">

                                    <RadzenText Text=@Model.USDEUR.ToString() class=@UISettings.TextBoxWithFieldNameclass Style="width: 100%;" />
                                </RadzenFormField>

                            </RadzenColumn>

                        </RadzenRow>
                    }
                </RadzenColumn>
                <RadzenColumn Size="12" SizeMD="3">
                    <RadzenFormField Text="PO Currency" Style="width: 100%;">
                        <RadzenText Text=@Model.PurchaseOrderCurrency.Name class=@UISettings.TextBoxWithFieldNameclass Style="width: 100%;" />


                    </RadzenFormField>
                </RadzenColumn>
                <RadzenColumn Size="12" SizeMD="3">
                    <RadzenFormField Text="SPL" Style="width: 100%;">
                        <RadzenText Text=@Model.SPL class=@UISettings.TextBoxWithFieldNameclass Style="width: 100%;" />


                    </RadzenFormField>
                </RadzenColumn>
            </RadzenRow>
            <RadzenRow>
                <RadzenColumn Size="12" SizeMD="6">
                    <RadzenRow>
                        <RadzenColumn Size="12" SizeMD="6">
                            <RadzenRadioButtonList Value="@WayToReceivePurchaseOrder" TValue="WayToReceivePurchaseorderEnum"
                                                   Change=@(args => OnChangeWayToReceivePurchaseOrder(args)) Orientation=Orientation.Horizontal
                                                   class="mb-3 mt-4">
                                <Items>
                                    <RadzenRadioButtonListItem Text="Complete" Value="WayToReceivePurchaseorderEnum.CompleteOrder" />
                                    <RadzenRadioButtonListItem Text="Percentage" Value="WayToReceivePurchaseorderEnum.PercentageOrder" />


                                </Items>
                            </RadzenRadioButtonList>
                        </RadzenColumn>
                        <RadzenColumn Size="12" SizeMD="6">
                            @if (WayToReceivePurchaseOrder.Id == WayToReceivePurchaseorderEnum.PercentageOrder.Id)
                            {
                                <RadzenRow>
                                    <RadzenFormField Text="Percentage To Receive" Style="width:100%;">
                                        <RadzenNumeric @bind-Value=@PercentageToReceive ShowUpDown=false class="w-100" TValue="double"
                                                       Max="100" Min="0"
                                                       @oninput="@((arg)=>OnChangeReceivePercentagePurchaseOrder(arg.Value!.ToString()!))">
                                        </RadzenNumeric>
                                    </RadzenFormField>

                                </RadzenRow>
                            }
                        </RadzenColumn>
                    </RadzenRow>
                </RadzenColumn>
                <RadzenColumn Size="12" SizeMD="6">
                    <RadzenRow>
                        <RadzenColumn Size="12" SizeMD="6">
                            <RadzenFormField Text="PO Value, $USD" Style="width: 100%;">
                                <RadzenText class=@UISettings.TextBoxWithFieldNameclass Style="width: 100%;">
                                    <b>@($"{String.Format(new System.Globalization.CultureInfo("en-US"), "{0:C0}", Model.POValueUSD)}")</b>
                                </RadzenText>

                            </RadzenFormField>

                        </RadzenColumn>
                        <RadzenColumn Size="12" SizeMD="6">
                            @if (Model.PurchaseOrderCurrency.Id != CurrencyEnum.USD.Id && Model.PurchaseOrderCurrency.Id != CurrencyEnum.None.Id)
                            {
                                <RadzenFormField Text=@($"PO Value, ${Model.PurchaseOrderCurrency.Name}") Style="width: 100%; height:100%">
                                    <RadzenText class=@UISettings.TextBoxWithFieldNameclass Style="width: 100%;">
                                        <b>@($"{String.Format(new System.Globalization.CultureInfo("en-US"), "{0:C0}", Model.POValueCurrency)}")</b>
                                    </RadzenText>
                                </RadzenFormField>


                            }
                        </RadzenColumn>
                    </RadzenRow>
                </RadzenColumn>

            </RadzenRow>
            <RadzenRow class="rz-mt-2">
                <RadzenColumn Size="12" SizeMD="3">
                    <RadzenButton Click="@SaveAsync" Variant="Variant.Flat" Text="@($"Receive PO {Model.PurchaseOrderNumber}")" Disabled=@(!Validated)
                                  MouseEnter="@(args => MainApp.ShowTooltip(args,$"Receive PO {Model.PurchaseOrderNumber}", TooltipPosition.Top) )" Style="width: 100%;" />
                </RadzenColumn>
                <RadzenColumn Size="12" SizeMD="3">
                    <RadzenButton Click="@Cancel" Variant="Variant.Flat" ButtonStyle="ButtonStyle.Light" Text="Cancel" Style="width: 100%"
                                  MouseEnter="@(args => MainApp.ShowTooltip(args,$"Cancel", TooltipPosition.Top) )" />
                </RadzenColumn>




            </RadzenRow>

            @if (debug)
            {

            }
            <CascadingValue Value="this">
                <NewPurchaseOrderItemRequestReceiveTable ValidateAsync="@ValidateAsync"></NewPurchaseOrderItemRequestReceiveTable>
            </CascadingValue>

        </EditForm>


    </RadzenStack>
}

@code {

}


